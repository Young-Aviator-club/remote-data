{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["export type ArrayTwoOrMore<T> = {\n  0: T;\n  1: T;\n} & Array<T>;\n\nexport type ReturnTypesOfFunctionProps<T> = {\n  [K in keyof T]: T[K] extends (...args: any) => infer R ? R : never;\n}[keyof T];\n\nexport type RemoteDataNotAsked = { type: 'NOT_ASKED' };\nexport type RemoteDataLoading = { type: 'LOADING' };\nexport type RemoteDataReloading = {\n  type: 'RELOADING';\n};\nexport type RemoteDataFailure<E> = { type: 'FAILURE'; error: E };\nexport type RemoteDataSuccess<D = unknown> = { type: 'SUCCESS'; data: D };\nexport type RemoteData<E, D> =\n  | RemoteDataNotAsked\n  | RemoteDataLoading\n  | RemoteDataReloading\n  | RemoteDataFailure<E>\n  | RemoteDataSuccess<D>;\n\nexport type FoldHandlers<E, D, R> = {\n  notAsked: () => R;\n  success: (data: D) => R;\n  loading?: () => R;\n  reloading?: () => R;\n  failure?: (error: E) => R;\n};\n\nexport type FolderHandlersRequired<E, D, R> = Required<\n  Omit<FoldHandlers<E, D, R>, 'reloading'>\n> & {\n  reloading?: () => R;\n};\n\nexport type FoldHandlersA<RDS, R> = {\n  notAsked: () => R;\n  success: (data: Extract<RDS, { type: 'SUCCESS'; data: unknown }>['data'][]) => R;\n  loading?: () => R;\n  reloading?: () => R;\n  failure?: (error: Extract<RDS, { type: 'FAILURE'; error: unknown }>['error'][]) => R;\n};\n\nexport type FolderHandlersARequired<RDS, R> = Required<\n  Omit<FoldHandlersA<RDS, R>, 'reloading'>\n> & {\n  reloading?: () => R;\n};\n\n/**\n * Return NOT_ASKED state\n *\n * @category Constructors\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data = RD.notAsked();\n */\nexport const notAsked = (): RemoteDataNotAsked => ({ type: 'NOT_ASKED' });\n\n/**\n * Return LOADING state\n *\n * @category Constructors\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data = RD.loading();\n */\nexport const loading = (): RemoteDataLoading => ({ type: 'LOADING' });\n\n/**\n * Return RELOADING state\n *\n * @category Constructors\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data = RD.reloading();\n */\nexport const reloading = (): RemoteDataReloading => ({ type: 'RELOADING' });\n\n/**\n * Return SUCCESS state with data\n *\n * @category Constructors\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data = RD.success({ userId: 1000 });\n */\nexport const success = <D>(data: D): RemoteDataSuccess<D> => ({\n  type: 'SUCCESS',\n  data,\n});\n\n/**\n * Return FAILURE state with error\n *\n * @category Constructors\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data = RD.failure(new Error('error'));\n */\nexport const failure = <E>(error: E): RemoteDataFailure<E> => ({\n  type: 'FAILURE',\n  error,\n});\n\n/**\n * Return true if remoteData is notAsked, else false\n *\n * @category Guards\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data = RD.notAsked();\n *   if (RD.isNotAsked(data)) {\n *     // ...your code\n *   }\n */\nexport function isNotAsked<R extends RemoteData<unknown, unknown>>(\n  remoteData: R,\n): boolean;\n\n/**\n * Return true if one of remoteData is notAsked, else false\n *\n * @category Guards\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data1 = RD.notAsked();\n *   const data2 = RD.loading();\n *\n *   if (RD.isNotAsked([data1, data2])) {\n *     // ...your code\n *   }\n */\nexport function isNotAsked<R extends ArrayTwoOrMore<RemoteData<unknown, unknown>>>(\n  remoteData: R,\n): boolean;\n\nexport function isNotAsked(remoteData: any): remoteData is RemoteDataNotAsked {\n  return Array.isArray(remoteData)\n    ? remoteData.some((rd) => rd.type === 'NOT_ASKED')\n    : remoteData.type === 'NOT_ASKED';\n}\n\n/**\n * Return true if remoteData is loading, else false\n *\n * @category Guards\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data = RD.loading();\n *   if (RD.isLoading(data)) {\n *     // ...your code\n *   }\n */\nexport function isLoading<R extends RemoteData<unknown, unknown>>(remoteData: R): boolean;\n\n/**\n * Return true if one of remoteData is loading, else false\n *\n * @category Guards\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data1 = RD.notAsked();\n *   const data2 = RD.loading();\n *\n *   if (RD.isNotAsked([data1, data2])) {\n *     // ...your code\n *   }\n */\nexport function isLoading<R extends ArrayTwoOrMore<RemoteData<unknown, unknown>>>(\n  remoteData: R,\n): boolean;\n\nexport function isLoading(remoteData: any): remoteData is RemoteDataLoading {\n  return Array.isArray(remoteData)\n    ? remoteData.some((rd) => rd.type === 'LOADING')\n    : remoteData.type === 'LOADING';\n}\n\n/**\n * Return true if remoteData is reloading, else false\n *\n * @category Guards\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data = RD.reloading();\n *   if (RD.isReloading(data)) {\n *     // ...your code\n *   }\n */\nexport function isReloading<R extends RemoteData<unknown, unknown>>(\n  remoteData: R,\n): boolean;\n\n/**\n * Return true if one of remoteData is reloading, else false\n *\n * @category Guards\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data1 = RD.notAsked();\n *   const data2 = RD.reloading();\n *\n *   if (RD.reloading([data1, data2])) {\n *     // ...your code\n *   }\n */\nexport function isReloading<R extends ArrayTwoOrMore<RemoteData<unknown, unknown>>>(\n  remoteData: R,\n): boolean;\n\nexport function isReloading(remoteData: any): remoteData is RemoteDataReloading {\n  return Array.isArray(remoteData)\n    ? remoteData.some((rd) => rd.type === 'RELOADING')\n    : remoteData.type === 'RELOADING';\n}\n\n/**\n * Return true if remoteData is success, else false\n *\n * @category Guards\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data = RD.success(1);\n *   if (RD.isSuccess(data)) {\n *     console.log(data.data); // typesave\n *   }\n */\nexport function isSuccess<R extends RemoteData<unknown, unknown>>(remoteData: R): boolean;\n\n/**\n * Return true if ALL of remoteData is success, else false\n *\n * @category Guards\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data1 = RD.success(1);\n *   const data2 = RD.success(2);\n *\n *   if (RD.isSuccess([data1, data2])) {\n *     console.log(data1.data, data2.data); // typesave\n *   }\n */\nexport function isSuccess<R extends ArrayTwoOrMore<RemoteData<unknown, unknown>>>(\n  remoteData: R,\n): boolean;\n\nexport function isSuccess(remoteData: any): remoteData is RemoteDataSuccess<unknown> {\n  return Array.isArray(remoteData)\n    ? remoteData.every((rd) => rd.type === 'SUCCESS')\n    : remoteData.type === 'SUCCESS';\n}\n\n/**\n * Return true if remoteData is failure, else false\n *\n * @category Guards\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data = RD.failure(new Error('some error'));\n *   if (RD.isFailure(data)) {\n *     // ...your code\n *   }\n */\nexport function isFailure<R extends RemoteData<unknown, unknown>>(remoteData: R): boolean;\n\n/**\n * Return true if one of remoteData is failure, else false\n *\n * @category Guards\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   const data1 = RD.failure(new Error('some error'));\n *   const data2 = RD.failure(new Error('some another error'));\n *\n *   if (RD.isFailure([data1, data2])) {\n *     // ...your code\n *   }\n */\nexport function isFailure<R extends ArrayTwoOrMore<RemoteData<unknown, unknown>>>(\n  remoteData: R,\n): boolean;\n\nexport function isFailure(remoteData: any): remoteData is RemoteDataFailure<unknown> {\n  return Array.isArray(remoteData)\n    ? remoteData.some((rd) => rd.type === 'FAILURE')\n    : remoteData.type === 'FAILURE';\n}\n\n/**\n * Accept remote data and orElse function and if SUCCESS return data, else all orElse\n *\n * @category Error handling / accessor\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   // example 1\n *   const data = RD.notAsked();\n *   const result = RD.successOrElse(data, () => -1); // -1\n *\n *   // example 2\n *   const data = RD.success(1);\n *   const result = RD.successOrElse(data, () => -1); // 1\n */\nexport function successOrElse<T extends RemoteData<unknown, unknown>, R>(\n  remoteData: T,\n  orElse: () => R,\n): (T extends RemoteDataSuccess<unknown> ? T['data'] : never) | R;\n\n/**\n * Accept array of remote data and orElse function and if ALL SUCCESS return array of\n * data, else all orElse\n *\n * @category Error handling / accessor\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   // example 1\n *   const data1 = RD.notAsked();\n *   const data2 = RD.notAsked();\n *   const result = RD.successOrElse([data1, data2], () => [0, 0]); // [0, 0]\n *\n *   // example 2\n *   const data1 = RD.success(1);\n *   const data2 = RD.success(2);\n *   const [first, second] = RD.successOrElse(data, () => [0, 0]); // [1, 2]\n */\nexport function successOrElse<T extends ArrayTwoOrMore<RemoteData<unknown, unknown>>, R>(\n  remoteData: T,\n  orElse: () => R,\n):\n  | (T extends ArrayTwoOrMore<RemoteDataSuccess<unknown>> ? T[number]['data'][] : never)\n  | R;\n\nexport function successOrElse(remoteData: any, orElse: any) {\n  if (Array.isArray(remoteData)) {\n    return isSuccess(remoteData as ArrayTwoOrMore<RemoteData<unknown, unknown>>)\n      ? remoteData.map((rd) => rd.data)\n      : orElse(remoteData);\n  }\n\n  if (isSuccess(remoteData)) {\n    return remoteData.data;\n  }\n\n  return orElse(remoteData);\n}\n\n/**\n * Accept remote data and object with handlers (state as cb)\n *\n * @category Pattern matching\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   // example 1\n *   const data = RD.notAsked();\n *   const result = RD.fold(data, { notAsked: () => 'no data', loading: () => 'loading...', success: (data) => `data: ${data}`);\n */\nexport function fold<E, D, R>(\n  remoteData: RemoteData<E, D>,\n  foldHandlers: FoldHandlers<E, D, R>,\n): ReturnTypesOfFunctionProps<R>;\n\n/**\n * Accept array of remote data and object with handler (state as cb)\n *\n * @category Pattern matching\n * @example\n *   import { RD } from '@young-aviator-club/remote-data';\n *\n *   // example 1\n *   const data1 = RD.notAsked();\n *   const data2 = RD.notAsked();\n *\n *   // return 'no data':\n *   const result = RD.fold([data1, data2], { notAsked: () => 'no data', loading: () => 'loading...', success: (data) => `data: ${data}`);\n *\n *   // example 2\n *   const data1 = RD.success(1);\n *   const data2 = RD.success(2);\n *\n *   // return 3:\n *   const result = RD.fold([data1, data2], { notAsked: () => 'no data', loading: () => 'loading...', success: ([a, b]) => a + b);\n */\nexport function fold<RDS, R>(\n  remoteData: ArrayTwoOrMore<RDS>,\n  foldHandlers: FoldHandlersA<RDS, R>,\n): ReturnTypesOfFunctionProps<R>;\n\nexport function fold(\n  remoteData: any,\n  { notAsked, loading, failure, success, reloading }: any,\n) {\n  if (Array.isArray(remoteData)) {\n    if (failure) {\n      const failedRds = remoteData.filter((rd) => isFailure(rd));\n      if (failedRds.length > 0) {\n        return failure(failedRds.map((rd) => rd.error));\n      }\n    }\n\n    if (loading) {\n      const loadingRds = remoteData.filter((rd) => isLoading(rd));\n\n      if (loadingRds.length > 0) {\n        return loading();\n      }\n    }\n\n    if (reloading) {\n      const reloadingRds = remoteData.filter((rd) => isReloading(rd));\n\n      if (reloadingRds.length > 0) {\n        return reloading();\n      }\n    }\n\n    const successRds = remoteData.filter((rd) => isSuccess(rd));\n\n    if (remoteData.length === successRds.length) {\n      return success(successRds.map((rd) => rd.data));\n    }\n\n    return notAsked();\n  }\n\n  if (remoteData.type === 'LOADING' && loading) {\n    return loading();\n  }\n\n  if (remoteData.type === 'RELOADING' && reloading) {\n    return reloading();\n  }\n\n  if (remoteData.type === 'FAILURE' && failure) {\n    return failure(remoteData.error);\n  }\n\n  if (remoteData.type === 'SUCCESS') {\n    return success(remoteData.data);\n  }\n\n  return notAsked();\n}\n"],"names":["isLoading","remoteData","Array","isArray","some","rd","type","isReloading","isSuccess","every","isFailure","error","_ref","notAsked","loading","failure","success","reloading","failedRds","filter","length","map","successRds","data","successOrElse","orElse"],"mappings":"AAwLgBA,SAAAA,EAAUC,GACxB,OAAYC,MAACC,QAAQF,GACjBA,EAAWG,KAAK,SAACC,GAAOA,MAAY,YAAZA,EAAGC,IAAkB,GACzB,YAApBL,EAAWK,IACjB,CAoCM,SAAqBC,EAACN,GAC1B,OAAOC,MAAMC,QAAQF,GACjBA,EAAWG,KAAK,SAACC,GAAE,MAAiB,cAAVA,EAACC,IAAoB,GAC3B,cAApBL,EAAWK,IACjB,CAkCgBE,SAAAA,EAAUP,GACxB,OAAYC,MAACC,QAAQF,GACjBA,EAAWQ,MAAM,SAACJ,GAAOA,MAAY,YAAZA,EAAGC,IAAkB,GAC1B,YAApBL,EAAWK,IACjB,CAkCM,SAAmBI,EAACT,GACxB,aAAaE,QAAQF,GACjBA,EAAWG,KAAK,SAACC,GAAE,MAAiB,YAAVA,EAACC,IAAkB,GACzB,YAApBL,EAAWK,IACjB,iBArMuB,SAAIK,GAAQ,MAA4B,CAC7DL,KAAM,UACNK,MAAAA,EACD,eAySe,SACdV,EACuDW,GAAA,IAA7CC,EAAAD,EAARC,SAAUC,EAAOF,EAAPE,QAASC,EAAAA,EAAAA,QAASC,EAAAA,EAAAA,QAASC,EAASL,EAATK,UAEvC,GAAIf,MAAMC,QAAQF,GAAa,CAC7B,GAAIc,EAAS,CACX,IAAeG,EAAGjB,EAAWkB,OAAO,SAACd,UAAgBK,EAACL,EAAG,GACzD,GAAIa,EAAUE,OAAS,EACrB,OAAcL,EAACG,EAAUG,IAAI,SAAChB,GAAE,OAAOA,EAACM,KAAK,GAEhD,CAED,GAAIG,GACiBb,EAAWkB,OAAO,SAACd,UAAgBL,EAACK,EAAG,GAE3Ce,OAAS,EACtB,OAAcN,IAIlB,GAAIG,GACmBhB,EAAWkB,OAAO,SAACd,GAAE,OAAgBE,EAACF,EAAG,GAE7Ce,OAAS,EACxB,OAAOH,IAIX,MAAmBhB,EAAWkB,OAAO,SAACd,GAAE,SAAeA,EAAG,GAE1D,OAAIJ,EAAWmB,SAAWE,EAAWF,OAC5BJ,EAAQM,EAAWD,IAAI,SAAChB,GAAOA,OAAAA,EAAGkB,IAAI,IAGxCV,GACR,CAED,MAAwB,YAApBZ,EAAWK,MAAsBQ,EAC5BA,IAGe,cAApBb,EAAWK,MAAwBW,EACrBA,IAGM,YAApBhB,EAAWK,MAAsBS,EACrBA,EAACd,EAAWU,OAGJ,YAApBV,EAAWK,KACCU,EAACf,EAAWsB,SAI9B,6DA3TM,SAAqBtB,GACzB,OAAOC,MAAMC,QAAQF,GACjBA,EAAWG,KAAK,SAACC,GAAE,MAAiB,gBAATC,IAAoB,GAC3B,cAApBL,EAAWK,IACjB,4DA/EuB,WAAH,MAA6B,CAAEA,KAAM,UAAW,mBAX5C,WAA2B,MAAA,CAAEA,KAAM,YAAa,oBAsB/C,WAAH,MAA+B,CAAEA,KAAM,YAAa,kBAWnD,SAAIiB,SAAmC,CAC5DjB,KAAM,UACNiB,KAAAA,EACD,wBA+PeC,SAAcvB,EAAiBwB,GAC7C,OAAIvB,MAAMC,QAAQF,GACAO,EAACP,GACbA,EAAWoB,IAAI,SAAChB,GAAOA,OAAAA,EAAGkB,IAAI,GAC9BE,EAAOxB,GAGTO,EAAUP,GACLA,EAAWsB,OAGNtB,EAChB"}